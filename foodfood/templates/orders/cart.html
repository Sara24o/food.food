{% extends 'base.html' %}
{% block title %}Panier{% endblock %}
{% block content %}
<h1>Panier</h1>
{% if restaurant %}
<p>Restaurant: {{ restaurant.name }}</p>
{% endif %}
<table class="table">
  <thead>
    <tr><th>Article</th><th>Qté</th><th>Total</th><th></th></tr>
  </thead>
  <tbody>
    {% for row in cart_items %}
    <tr>
      <td>{{ row.menu_item.name }}</td>
      <td>{{ row.quantity }}</td>
      <td>{{ row.line_total }} €</td>
      <td>
        <a href="/orders/remove/{{ row.menu_item.id }}/" class="btn btn-sm btn-outline-danger">-</a>
        <a href="/orders/add/{{ row.menu_item.id }}/" class="btn btn-sm btn-outline-success">+</a>
      </td>
    </tr>
    {% empty %}
    <tr><td colspan="4">Votre panier est vide.</td></tr>
    {% endfor %}
  </tbody>
</table>
<div class="d-flex justify-content-end gap-3">
  <span>Sous-total: <strong>{{ subtotal }} €</strong></span>
  <span>Livraison: <strong>{{ delivery_fee }} €</strong></span>
  <span>Total: <strong>{{ total }} €</strong></span>
</div>
<form method="post" action="/orders/checkout/" class="mt-3">
  {% csrf_token %}
  <button class="btn btn-primary" {% if not cart_items %}disabled{% endif %}>Valider la commande</button>
  <a href="/restaurants/" class="btn btn-link">Continuer vos achats</a>
  <a href="/orders/history/" class="btn btn-outline-secondary">Mes commandes</a>
</form>
{% endblock %}


